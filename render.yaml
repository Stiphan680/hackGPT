services:
  - type: web
    name: hackgpt
    env: docker
    plan: free
    repo: https://github.com/Stiphan680/hackGPT.git
    branch: main
    dockerfilePath: ./Dockerfile
    ports:
      - port: 8501
        protocol: HTTP
    envVars:
      - key: OPENAI_API_KEY
        scope: runtime
        sync: false
      - key: JIRA_SERVER
        scope: runtime
        sync: false
      - key: JIRA_USER
        scope: runtime
        sync: false
      - key: JIRA_TOKEN
        scope: runtime
        sync: false
      - key: STREAMLIT_SERVER_HEADLESS
        value: "true"
      - key: PYTHONUNBUFFERED
        value: "1"
    buildCommand: "pip install --no-cache-dir -r requirements-prod.txt && mkdir -p personas output"
    startCommand: "streamlit run hackGPTv23.py --server.port=8501 --server.address=0.0.0.0 --client.showErrorDetails=false"
    autoDeploy: true
    disk:
      name: hackgpt-storage
      mountPath: /app/data
      sizeGB: 1
